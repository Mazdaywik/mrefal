.:  ..
    rem .Config\save_config _last
    cd ..
    ncmenu
-:  
C:  Компилировать (%COMP-SHORT%, %PROFILE-SHORT%)
    if NOT %PATHSET%==SET set PATH=%PATH%;..\..\Bin
    if NOT %PATHSET%==SET set PATHSET=SET
    %COMP% %MODE% +cfg:%PROFILE%.prj
    if exist __errors view:__errors
B:  Компилировать (%COMP-SHORT%, %PROFILE-SHORT%) 2>__err
    if NOT %PAHTSET%==SET SET PATH=%PATH%;..\..\Bin
    if NOT %PAHTSET%==SET set PATHSET=SET
    %COMP% %MODE% +cfg:%PROFILE%.prj 2>__err >__out
    view:__err
S:  Перекомпилировать/stable (%SCOMP-SHORT%, %SPROFILE-SHORT%)
    if NOT %PAHTSET%==SET SET PATH=%PATH%;..\..\Bin
    if NOT %PAHTSET%==SET set PATHSET=SET
    %SCOMP% %MODE% +cfg:%SPROFILE%.cfg +xlinx MRefal
    if exist __errors view:__errors
-:  
M:  Пересборка
    build.bat
-:  
K:  Проверить (%COMP-SHORT%, %PROFILE-SHORT%) -> (%COMP-SHORT%, %PROFILE-SHORT%)
    if NOT %PAHTSET%==SET set PATH=%PATH%;..\..\Bin
    if NOT %PAHTSET%==SET set PATHSET=SET
    %COMP% %MODE% +cfg:%PROFILE%.prj
    %COMP% %MODE% +cfg:%PROFILE%.prj
    if exist __errors view:__errors
H:  Проверить/stable (%SCOMP-SHORT%, %SPROFILE-SHORT%) -> (%COMP-SHORT%, %PROFILE-SHORT%)
    if NOT %PAHTSET%==SET set PATH=%PATH%;..\..\Bin
    if NOT %PAHTSET%==SET set PATHSET=SET
    %SCOMP% %MODE% +cfg:%SPROFILE%.cfg +xlinx MRefal
    %COMP% %MODE% +cfg:%PROFILE%.prj
    if exist __errors view:__errors
G:  Проверить/stable (%SCOMP-SHORT%, %SPROFILE-SHORT%) -> (%COMP-SHORT%, %PROFILE-SHORT%) 2>__err
    if NOT %PAHTSET%==SET set PATH=%PATH%;..\..\Bin
    if NOT %PAHTSET%==SET set PATHSET=SET
    %SCOMP% %MODE% +cfg:%SPROFILE%.cfg +xlinx MRefal
    %COMP% %MODE% +cfg:%PROFILE%.prj >__out 2>__err
    view:__err
-:  
T:  Перейти
{
C:  Cpp-SR-BE
    cd Cpp-SR-BE
    ncmenu
M:  MRefal-FE
    cd MRefal-FE
    ncmenu
R:  Refal5
    cd Refal5
    ncmenu
S:  SRefal-BE
    cd SRefal-BE
    ncmenu
}
-:  
I:  Статистика и информация
{
A:  Псевдонимы (Рефал 5)
    view:.Info\Aliases.als
I:  Интерфейсы
    view:interfaces.txt
U:  Обновить интерфейсы
    subst V: ..
    dir /b /s V:\*.mref>mrefs.tmp
    refgo ..\..\Bin\Grab_info @mrefs.tmp
    subst V: /D
    del mrefs.tmp
    view:interfaces.txt
-:  
L:  Список нескомпонованных элементов
    cd .Info
    unlib.bat
    cd ..
    view:.Info/"Not linked.txt
K:  Список нескомпонованных элементов
    view:".Info/MRefal%PROFILE-ACRO%.not linked.txt"
T:  Показ дерева модулей
    view:.Info/MRefal%PROFILE-ACRO%.tree.txt
X:  Перекрёстные связи
    view:.Info/MRefal%PROFILE-ACRO%.xlinx.txt
}
-:  
E:  Декодировать файл дампа !.! (6 Кбайт/с)
    copy !.! !.!.bak
    refgo -l1000 -t ..\..\Bin\ErrorDecoder !.!
    view:!.!
F:  Конфигурация
{
M:  Режим %MODE% (сменить)
{
F:  Полная перекомпиляция
    set MODE=+build
    .Config\ncmenu
M:  Make
    set MODE=+make
    .Config\ncmenu
L:  Только линковка
    set MODE=+linkonly
    .Config\ncmenu
}
-:  
C:  Компилятор %COMP-SHORT% (сменить)
{
:  [Установка основного компилятора (по умолчанию %COMP-SHORT%)]
-:  
5:  Рефал 5
    set COMP=start-r5.bat
    set COMP-SHORT=R5
    set SPROFILE=mp-stable-R5
    set SPROFILE-SHORT=R5
    ncmenu
T:  Рефал 5 с замером времени
    set COMP=start-r5-t.bat
    set COMP-SHORT=R5
    set SPROFILE=mp-stable-R5
    set SPROFILE-SHORT=R5
    ncmenu
S:  Простой Рефал
    set COMP=start-sr
    set COMP-SHORT=SR
    set SPROFILE=mp-stable-SR
    set SPROFILE-SHORT=SR
    ncmenu
C:  Back-end Си++/Простой Рефал
    set SPROFILE=mp-stable-CPPSR
    set SPROFILE-SHORT=Си++/SR
    set COMP=start-cpp
    set COMP-SHORT=C++/SR
    ncmenu
-:  
D:  Оставить по умолчанию (%COMP-SHORT%)
    ncmenu
}
P:  Профиль %PROFILE-SHORT% (сменить)
{
:  [Установка основного профиля (по умолчанию %PROFILE-SHORT%)]
-:  
5:  Рефал 5
    set PROFILE=mp-work-R5
    set PROFILE-SHORT=R5
    set PROFILE-ACRO=
    ncmenu
S:  Простой Рефал
    set PROFILE=mp-work-SR
    set PROFILE-SHORT=SR
    set PROFILE-ACRO=.sr.exe
    ncmenu
C:  Back-end Си++/Простой Рефал
    set PROFILE=mp-work-CPPSR
    set PROFILE-SHORT=Си++/SR
    set PROFILE-ACRO=.cppsr.exe
    ncmenu
-:  
D:  Оставить по умолчанию (%PROFILE-SHORT%)
    ncmenu
}
S:  Стабильный компилятор %SCOMP-SHORT%  (сменить)
{
:  [Установка стабильного компилятора (по умолчанию %SCOMP-SHORT%)]
-:  
5:  Рефал 5
    set SCOMP=refgo -c150 -l30 MRefal.s.rsl
    set SCOMP-SHORT=R5
    ncmenu
S:  Простой Рефал
    set SCOMP=mrefal.s.exe
    set SCOMP-SHORT=SR
    ncmenu
C:  Back-end Си++/Простой Рефал
    set SCOMP=mrefal.s.cpp.exe
    set SCOMP-SHORT=C++/SR
    ncmenu
-:  
D:  Оставить по умолчанию (%SCOMP-SHORT%)
    ncmenu
}
T:  Стабильный профиль %SPROFILE-SHORT% (сменить)
{
:  [Установка стабильного профиля (по умолчанию %SPROFILE-SHORT%)]
-:  
5:  Рефал 5
    set SPROFILE=mp-stable-R5
    set SPROFILE-SHORT=R5
    ncmenu
S:  Простой Рефал
    set SPROFILE=mp-stable-SR
    set SPROFILE-SHORT=SR
    ncmenu
C:  Back-end Си++/Простой Рефал
    set SPROFILE=mp-stable-CPPSR
    set SPROFILE-SHORT=Си++/SR
-:  
D:  Оставить по умолчанию (%SPROFILE-SHORT%)
    ncmenu
}
-:  
L:  Загрузить конфигурацию
    .Config\load_config !?Укажите имя конфигурации?!
    echo %MODE%
    .Config\ncmenu
V:  Сохранить конфигурацию
    .Config\save_config !?Укажите имя конфигурации?!
    .Config\ncmenu
-:  
R:  Загрузить последнюю конфигурацию
    .Config\load_config _last
    echo %MODE%
    .Config\ncmenu
A:  Сохранить как последнюю конфигурацию
    .Config\save_config _last
    .Config\ncmenu
}
-:  
F7:  Сохранить окно
    .Config\save_window default
