$MODULE CoreBE::MForceExit;

$NATIVE CppSR TOPLEVEL @@'
#include <assert.h>

static refalrts::ExternalReference ref_ExitE_("Exit#ENTRY", 0, 0);
'@@;


$NATIVE CppSR FUNCTION
$ENTRY ForceExit @@'
  refalrts::Iter func_name = arg_begin->next;
  assert(func_name->tag == refalrts::cDataFunction);
  func_name->function_info = ref_ExitE_.ref(vm);
  refalrts::push_stack(vm, arg_end);
  refalrts::push_stack(vm, arg_begin);
  return refalrts::cSuccess;
'@@;

$END CoreBE::MForceExit.
