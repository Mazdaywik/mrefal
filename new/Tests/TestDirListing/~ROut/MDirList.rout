v ROUT3 Module Refal 0.1
r file Tests\TestDirListing\~ROut\MDirList.rout

b Entry::MDirList::GetList
c $Entry::MDirList::GetList$ {
c 	e.$Index::DirName$ =
c 		<$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) <$Entry::MFileSystem::DirList$ e.$Index::DirName$ > > ;
c }

b Local::MDirList::MakeList
c $Local::MDirList::MakeList$ {
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) $Ident::Success$ e.$Index::Tail$ =
c 		<$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) e.$Index::Tail$ > ;
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) $Ident::Fails$ e.$Index::Tail$ =
c 		<$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) e.$Index::Tail$ > ;
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) ( $ADT::__StructureBrackets$ '.' ) e.$Index::Tail$ =
c 		<$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) e.$Index::Tail$ > ;
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) ( $ADT::__StructureBrackets$ '..' ) e.$Index::Tail$ =
c 		<$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) e.$Index::Tail$ > ;
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) ( $ADT::__StructureBrackets$ e.$Index::Name$ ) e.$Index::Tail$ =
c 		<$Local::MDirList::MakeDirEntry$ e.$Index::DirName$ '/' e.$Index::Name$ > <$Local::MDirList::MakeList$ ( $ADT::__StructureBrackets$ e.$Index::DirName$ ) e.$Index::Tail$ > ;
c 	( $ADT::__StructureBrackets$ e.$Index::DirName$ ) =
c 		;
c }

b Local::MDirList::MakeDirEntry
c $Local::MDirList::MakeDirEntry$ {
c 	e.$Index::Name$ =
c 		( $ADT::MDirList::DirEntry$ <$Entry::MFileSystem::FileAttribute$ $Ident::DateTime$ e.$Index::Name$ > <$Entry::MFileSystem::FileAttribute$ $Ident::Size$ e.$Index::Name$ > ( $ADT::__StructureBrackets$ e.$Index::Name$ ) ) ;
c }

b Entry::MDirList::GetName
c $Entry::MDirList::GetName$ {
c 	( $ADT::MDirList::DirEntry$ t.$Index::DateTime$ t.$Index::Size$ ( $ADT::__StructureBrackets$ e.$Index::FileName$ ) ) =
c 		e.$Index::FileName$ ;
c }

b Entry::MDirList::GetSize
c $Entry::MDirList::GetSize$ {
c 	( $ADT::MDirList::DirEntry$ t.$Index::DateTime$ ( $ADT::__StructureBrackets$ s.$Index::Size$ ) t.$Index::FileName$ ) =
c 		s.$Index::Size$ ;
c }

b Entry::MDirList::GetTime
c $Entry::MDirList::GetTime$ {
c 	( $ADT::MDirList::DirEntry$ ( $ADT::__StructureBrackets$ e.$Index::Time$ ) t.$Index::Size$ t.$Index::FileName$ ) =
c 		e.$Index::Time$ ;
c }

b Entry::MDirList::GetListRec
c $Entry::MDirList::GetListRec$ {
c 	e.$Index::DirName$ =
c 		<$Local::MDirList::ScanForRecursive$ <$Entry::MDirList::GetList$ e.$Index::DirName$ > > ;
c }

b Local::MDirList::ScanForRecursive
c $Local::MDirList::ScanForRecursive$ {
c 	e.$Index::IsNotDirs$ ( $ADT::MDirList::DirEntry$ t.$Index::Time$ ( $ADT::__StructureBrackets$ $Ident::Directory$ ) ( $ADT::__StructureBrackets$ e.$Index::FileName$ ) ) e.$Index::Tail$ =
c 		e.$Index::IsNotDirs$ ( $ADT::MDirList::DirEntry$ t.$Index::Time$ ( $ADT::__StructureBrackets$ $Ident::Directory$ ) ( $ADT::__StructureBrackets$ e.$Index::FileName$ ) ) <$Local::MDirList::ScanForRecursive$ <$Entry::MDirList::GetList$ <$Entry::MSelfDiag::Log-T$ e.$Index::FileName$ > > e.$Index::Tail$ > ;
c 	e.$Index::IsNotDirs$ =
c 		e.$Index::IsNotDirs$ ;
c }

